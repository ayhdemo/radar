(function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(t)}else if(window.opera&&window.opera.postError){window.opera.postError(t)}}}e.fn.ajaxSubmit=function(n){function g(){function v(){var t=c.attr("target"),n=c.attr("action");r.setAttribute("target",o);if(r.getAttribute("method")!="POST"){r.setAttribute("method","POST")}if(r.getAttribute("action")!=i.url){r.setAttribute("action",i.url)}if(!i.skipEncodingOverride){c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(i.timeout){d=setTimeout(function(){p=true;w(true)},i.timeout)}var s=[];try{if(i.extraData){for(var f in i.extraData){s.push(e('<input type="hidden" name="'+f+'" value="'+i.extraData[f]+'" />').appendTo(r)[0])}}if(!i.iframeTarget){u.appendTo("body");a.attachEvent?a.attachEvent("onload",w):a.addEventListener("load",w,false)}r.submit()}finally{r.setAttribute("action",n);if(t){r.setAttribute("target",t)}else{c.removeAttr("target")}e(s).remove()}}function w(n){if(f.aborted||b){return}if(n===true&&f){f.abort("timeout");return}var r=a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document;if(!r||r.location.href==i.iframeSrc){if(!p)return}a.detachEvent?a.detachEvent("onload",w):a.removeEventListener("load",w,false);var o="success",l;try{if(p){throw"timeout"}var c=i.dataType=="xml"||r.XMLDocument||e.isXMLDoc(r);t("isXml="+c);if(!c&&window.opera&&(r.body==null||r.body.innerHTML=="")){if(--y){t("requeing onLoad callback, DOM not available");setTimeout(w,250);return}}var h=r.body?r.body:r.documentElement;f.responseText=h?h.innerHTML:null;f.responseXML=r.XMLDocument?r.XMLDocument:r;if(c)i.dataType="xml";f.getResponseHeader=function(e){var t={"content-type":i.dataType};return t[e]};if(h){f.status=Number(h.getAttribute("status"))||f.status;f.statusText=h.getAttribute("statusText")||f.statusText}var v=/(json|script|text)/.test(i.dataType.toLowerCase());if(v||i.textarea){var g=r.getElementsByTagName("textarea")[0];if(g){f.responseText=g.value;f.status=Number(g.getAttribute("status"))||f.status;f.statusText=g.getAttribute("statusText")||f.statusText}else if(v){var S=r.getElementsByTagName("pre")[0];var T=r.getElementsByTagName("body")[0];if(S){f.responseText=S.textContent?S.textContent:S.innerHTML}else if(T){f.responseText=T.innerHTML}}}else if(i.dataType=="xml"&&!f.responseXML&&f.responseText!=null){f.responseXML=E(f.responseText)}try{m=x(f,i.dataType,i)}catch(n){o="parsererror";f.error=l=n||o}}catch(n){t("error caught",n);o="error";f.error=l=n||o}if(f.aborted){t("upload aborted");o=null}if(f.status){o=f.status>=200&&f.status<300||f.status===304?"success":"error"}if(o==="success"){i.success&&i.success.call(i.context,m,"success",f);s&&e.event.trigger("ajaxSuccess",[f,i])}else if(o){if(l==undefined)l=f.statusText;i.error&&i.error.call(i.context,f,o,l);s&&e.event.trigger("ajaxError",[f,i,l])}s&&e.event.trigger("ajaxComplete",[f,i]);if(s&&!--e.active){e.event.trigger("ajaxStop")}i.complete&&i.complete.call(i.context,f,o);b=true;if(i.timeout)clearTimeout(d);setTimeout(function(){if(!i.iframeTarget)u.remove();f.responseXML=null},100)}var r=c[0],i,s,o,u,a,f,l,h,p,d;if(e(":input[name=submit],:input[id=submit]",r).length){alert('Error: Form elements must not have name or id of "submit".');return}i=e.extend(true,{},e.ajaxSettings,n);i.context=i.context||i;u,o="jqFormIO"+(new Date).getTime();if(i.iframeTarget){u=e(i.iframeTarget);h=u.attr("name");if(h==null)u.attr("name",o);else o=h}else{u=e('<iframe name="'+o+'" src="'+i.iframeSrc+'" ></300>');u.css({position:"absolute",top:"-1000px",left:"-1000px"})}a=u[0];f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var r=n==="timeout"?"timeout":"aborted";t("aborting upload... "+r);this.aborted=1;u.attr("src",i.iframeSrc);f.error=r;i.error&&i.error.call(i.context,f,r,r);s&&e.event.trigger("ajaxError",[f,i,r]);i.complete&&i.complete.call(i.context,f,r)}};s=i.global;if(s&&!(e.active++)){e.event.trigger("ajaxStart")}if(s){e.event.trigger("ajaxSend",[f,i])}if(i.beforeSend&&i.beforeSend.call(i.context,f,i)===false){if(i.global){e.active--}return}if(f.aborted){return}l=r.clk;if(l){h=l.name;if(h&&!l.disabled){i.extraData=i.extraData||{};i.extraData[h]=l.value;if(l.type=="image"){i.extraData[h+".x"]=r.clk_x;i.extraData[h+".y"]=r.clk_y}}}if(i.forceSync){v()}else{setTimeout(v,10)}var m,g,y=50,b;var E=e.parseXML||function(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else{t=(new DOMParser).parseFromString(e,"text/xml")}return t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null};var S=e.parseJSON||function(e){return window["eval"]("("+e+")")};var x=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;if(s&&o.documentElement.nodeName==="parsererror"){e.error&&e.error("parsererror")}if(r&&r.dataFilter){o=r.dataFilter(o,n)}if(typeof o==="string"){if(n==="json"||!n&&i.indexOf("json")>=0){o=S(o)}else if(n==="script"||!n&&i.indexOf("javascript")>=0){e.globalEval(o)}}return o}}if(!this.length){t("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof n=="function"){n={success:n}}var r=this.attr("action");var i=typeof r==="string"?e.trim(r):"";i=i||window.location.href||"";if(i){i=(i.match(/^([^#]+)/)||[])[1]}n=e.extend(true,{url:i,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var s={};this.trigger("form-pre-serialize",[this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===false){t("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var o,u,a=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(o in n.data){if(n.data[o]instanceof Array){for(var f in n.data[o]){a.push({name:o,value:n.data[o][f]})}}else{u=n.data[o];u=e.isFunction(u)?u():u;a.push({name:o,value:u})}}}if(n.beforeSubmit&&n.beforeSubmit(a,this,n)===false){t("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var l=e.param(a);if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+l;n.data=null}else{n.data=l}var c=this,h=[];if(n.resetForm){h.push(function(){c.resetForm()})}if(n.clearForm){h.push(function(){c.clearForm()})}if(!n.dataType&&n.target){var p=n.success||function(){};h.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(p,arguments)})}else if(n.success){h.push(n.success)}n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=h.length;s<o;s++){h[s].apply(i,[e,t,r||c,c])}};var d=e("input:file",this).length>0;var v="multipart/form-data";var m=c.attr("enctype")==v||c.attr("encoding")==v;if(n.iframe!==false&&(d||n.iframe||m)){if(n.closeKeepAlive){e.get(n.closeKeepAlive,g)}else{g()}}else{e.ajax(n)}this.trigger("form-submit-notify",[this,n]);return this};e.fn.ajaxForm=function(n){if(this.length===0){var r={s:this.selector,c:this.context};if(!e.isReady&&r.s){t("DOM not ready, queuing ajaxForm");e(function(){e(r.s,r.c).ajaxForm(n)});return this}t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){if(!t.isDefaultPrevented()){t.preventDefault();e(this).ajaxSubmit(n)}}).bind("click.form-plugin",function(t){var n=t.target;var r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length==0){return}n=i[0]}var s=this;s.clk=n;if(n.type=="image"){if(t.offsetX!=undefined){s.clk_x=t.offsetX;s.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left;s.clk_y=t.pageY-o.top}else{s.clk_x=t.pageX-n.offsetLeft;s.clk_y=t.pageY-n.offsetTop}}setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(t){var n=[];if(this.length===0){return n}var r=this[0];var i=t?r.getElementsByTagName("*"):r.elements;if(!i){return n}var s,o,u,a,f,l,c;for(s=0,l=i.length;s<l;s++){f=i[s];u=f.name;if(!u){continue}if(t&&r.clk&&f.type=="image"){if(!f.disabled&&r.clk==f){n.push({name:u,value:e(f).val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}continue}a=e.fieldValue(f,true);if(a&&a.constructor==Array){for(o=0,c=a.length;o<c;o++){n.push({name:u,value:a[o]})}}else if(a!==null&&typeof a!="undefined"){n.push({name:u,value:a})}}if(!t&&r.clk){var h=e(r.clk),p=h[0];u=p.name;if(u&&!p.disabled&&p.type=="image"){n.push({name:u,value:h.val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}}return n};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r=this.name;if(!r){return}var i=e.fieldValue(this,t);if(i&&i.constructor==Array){for(var s=0,o=i.length;s<o;s++){n.push({name:r,value:i[s]})}}else if(i!==null&&typeof i!="undefined"){n.push({name:this.name,value:i})}});return e.param(n)};e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r];var o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length){continue}o.constructor==Array?e.merge(n,o):n.push(o)}return n};e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();if(n===undefined){n=true}if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1)){return null}if(s=="select"){var o=t.selectedIndex;if(o<0){return null}var u=[],a=t.options;var f=i=="select-one";var l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;if(!p){p=h.attributes&&h.attributes["value"]&&!h.attributes["value"].specified?h.text:h.value}if(f){return p}u.push(p)}}return u}return e(t).val()};e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})};e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();if(e=="text"||e=="password"||t=="textarea"){this.value=""}else if(e=="checkbox"||e=="radio"){this.checked=false}else if(t=="select"){this.selectedIndex=-1}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType){this.reset()}})};e.fn.enable=function(e){if(e===undefined){e=true}return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){if(t===undefined){t=true}return this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio"){this.checked=t}else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");if(t&&r[0]&&r[0].type=="select-one"){r.find("option").selected(false)}this.selected=t}})};})(jQuery)